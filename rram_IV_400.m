function [state, I]=rram_IV_400(V)
%close all;
%clear all;
%V=linspace(-1.5,1.5,100);
%state=1; % 1 means HRS

a=[0,-1.12E-09
    0.015,1.44E-06
    0.03,2.88E-06
    0.045,4.33E-06
    0.06,5.77E-06
    0.075,7.19E-06
    0.09,8.46E-06
    0.105,9.95E-06
    0.12,1.14E-05
    0.135,1.29E-05
    0.15,1.42E-05
    0.165,1.58E-05
    0.18,1.74E-05
    0.195,1.89E-05
    0.21,2.03E-05
    0.225,2.20E-05
    0.24,2.38E-05
    0.255,2.70E-05
    0.27,2.88E-05
    0.285,3.03E-05
    0.3,3.21E-05
    0.315,3.10E-05
    0.33,3.24E-05
    0.345,3.33E-05
    0.36,3.56E-05
    0.375,3.62E-05
    0.39,4.06E-05
    0.405,3.97E-05
    0.42,3.44E-05
    0.435,3.54E-05
    0.45,3.33E-05
    0.465,3.61E-05
    0.48,3.88E-05
    0.495,3.99E-05
    0.51,4.16E-05
    0.525,4.13E-05
    0.54,4.34E-05
    0.555,4.90E-05
    0.57,4.87E-05
    0.585,5.26E-05
    0.6,5.26E-05
    0.615,5.75E-05
    0.63,5.96E-05
    0.645,5.87E-05
    0.66,5.87E-05
    0.675,6.31E-05
    0.69,6.95E-05
    0.705,8.00E-05
    0.72,7.91E-05
    0.735,7.78E-05
    0.75,8.10E-05
    0.765,7.58E-05
    0.78,7.54E-05
    0.795,0.001000051
    0.81,0.001000046
    0.825,0.001000045
    0.84,0.001000046
    0.855,0.001000046
    0.87,0.001000046
    0.885,0.001000045
    0.9,0.001000046
    0.915,0.001000045
    0.93,0.001000045
    0.945,0.001000046
    0.96,0.001000046
    0.975,0.001000046
    0.99,0.001000045
    1.005,0.001000044
    1.02,0.001000045
    1.035,0.001000046
    1.05,0.001000046
    1.065,0.001000047
    1.08,0.001000045
    1.095,0.001000046
    1.11,0.001000046
    1.125,0.001000046
    1.14,0.001000046
    1.155,0.001000046
    1.17,0.001000044
    1.185,0.001000045
    1.2,0.001000045
    1.215,0.001000045
    1.23,0.001000046
    1.245,0.001000046
    1.26,0.001000045
    1.275,0.001000045
    1.29,0.001000046
    1.305,0.001000046
    1.32,0.001000046
    1.335,0.001000045
    1.35,0.001000044
    1.365,0.001000045
    1.38,0.001000045
    1.395,0.001000045
    1.41,0.001000045
    1.425,0.001000046
    1.44,0.001000045
    1.455,0.001000045
    1.47,0.001000045
    1.485,0.001000047
    1.5,0.001000045];
b=[
    1.5,0.001000046
    1.485,0.001000044
    1.47,0.001000047
    1.455,0.001000045
    1.44,0.001000045
    1.425,0.001000045
    1.41,0.001000046
    1.395,0.001000046
    1.38,0.001000045
    1.365,0.001000046
    1.35,0.001000044
    1.335,0.001000045
    1.32,0.001000046
    1.305,0.001000045
    1.29,0.001000045
    1.275,0.001000046
    1.26,0.001000044
    1.245,0.001000045
    1.23,0.001000045
    1.215,0.001000046
    1.2,0.001000046
    1.185,0.001000045
    1.17,0.001000045
    1.155,0.001000045
    1.14,0.001000047
    1.125,0.001000045
    1.11,0.001000045
    1.095,0.001000046
    1.08,0.001000045
    1.065,0.001000045
    1.05,0.001000046
    1.035,0.001000045
    1.02,0.001000045
    1.005,0.001000046
    0.99,0.001000046
    0.975,0.001000044
    0.96,0.001000046
    0.945,0.001000046
    0.93,0.001000045
    0.915,0.001000047
    0.9,0.001000045
    0.885,0.001000046
    0.87,0.001000045
    0.855,0.001000045
    0.84,0.001000045
    0.825,0.001000046
    0.81,0.001000045
    0.795,0.001000045
    0.78,0.001000045
    0.765,0.001000045
    0.75,0.001000045
    0.735,0.001000045
    0.72,0.001000045
    0.705,0.001000045
    0.69,0.001000045
    0.675,0.001000045
    0.66,0.001000044
    0.645,0.000979602
    0.63,0.000952963
    0.615,0.000930853
    0.6,0.000905389
    0.585,0.000879963
    0.57,0.000855471
    0.555,0.00083126
    0.54,0.000807238
    0.525,0.000782624
    0.51,0.000758181
    0.495,0.000734115
    0.48,0.000709921
    0.465,0.000686426
    0.45,0.000662834
    0.435,0.00063887
    0.42,0.000613707
    0.405,0.000589792
    0.39,0.00056665
    0.375,0.000543819
    0.36,0.000520747
    0.345,0.000497648
    0.33,0.000474516
    0.315,0.000452375
    0.3,0.000429829
    0.285,0.000407339
    0.27,0.000384886
    0.255,0.000362372
    0.24,0.000340314
    0.225,0.000318261
    0.21,0.000296348
    0.195,0.000274778
    0.18,0.000253107
    0.165,0.000231473
    0.15,0.000209959
    0.135,0.000188188
    0.12,0.000165853
    0.105,0.000145326
    0.09,0.000123961
    0.075,0.00010342
    0.06,8.24E-05
    0.045,6.17E-05
    0.03,4.12E-05
    0.015,2.06E-05
    0,-2.74E-08
    -0.015,-2.06E-05
    -0.03,-4.14E-05
    -0.045,-6.21E-05
    -0.06,-8.29E-05
    -0.075,-0.000103726
    -0.09,-0.000124722
    -0.105,-0.000145687
    -0.12,-0.000166792
    -0.135,-0.000187913
    -0.15,-0.000209186
    -0.165,-0.000230538
    -0.18,-0.000252103
    -0.195,-0.000273615
    -0.21,-0.000295489
    -0.225,-0.0003172
    -0.24,-0.000339292
    -0.255,-0.00036136
    -0.27,-0.000383434
    -0.285,-0.00040562
    -0.3,-0.000427439
    -0.315,-0.000449242
    -0.33,-0.000472234
    -0.345,-0.000495146
    -0.36,-0.000518569
    -0.375,-0.000541854
    -0.39,-0.000565225
    -0.405,-0.000588891
    -0.42,-0.000612319
    -0.435,-0.000635399
    -0.45,-0.00065987
    -0.465,-0.000682946
    -0.48,-0.000706649
    -0.495,-0.000730081
    -0.51,-0.000756874
    -0.525,-0.000781947
    -0.54,-0.000803353
    -0.555,-0.000826566
    -0.57,-0.000858058
    -0.585,-0.000879677
    -0.6,-0.000899886
    -0.615,-0.000917908
    -0.63,-0.000934822
    -0.645,-0.000948174
    -0.66,-0.000961089
    -0.675,-0.000954774
    -0.69,-0.000955685
    -0.705,-0.000943492
    -0.72,-0.000931308
    -0.735,-0.000921304
    -0.75,-0.000918191
    -0.765,-0.000882966
    -0.78,-0.000854401
    -0.795,-0.000805595
    -0.81,-0.00077227
    -0.825,-0.000756437
    -0.84,-0.000740527
    -0.855,-0.000731662
    -0.87,-0.000747227
    -0.885,-0.000711736
    -0.9,-0.000683884
    -0.915,-0.000636171
    -0.93,-0.000602696
    -0.945,-0.000512934
    -0.96,-0.000463097
    -0.975,-0.000379235
    -0.99,-0.000403069
    -1.005,-0.000348891
    -1.02,-0.00032263
    -1.035,-0.000330835
    -1.05,-0.000327395
    -1.065,-0.000398286
    -1.08,-0.000337376
    -1.095,-0.000329782
    -1.11,-0.000338775
    -1.125,-0.00031989
    -1.14,-0.000310719
    -1.155,-0.000329998
    -1.17,-0.000339886
    -1.185,-0.000348133
    -1.2,-0.000355431
    -1.215,-0.000393753
    -1.23,-0.000444443
    -1.245,-0.0004855
    -1.26,-0.000474851
    -1.275,-0.000453936
    -1.29,-0.000452381
    -1.305,-0.000490727
    -1.32,-0.000475763
    -1.335,-0.000473924
    -1.35,-0.000485598
    -1.365,-0.00043748
    -1.38,-0.000412815
    -1.395,-0.000444497
    -1.41,-0.000435505
    -1.425,-0.000375332
    -1.44,-0.000352511
    -1.455,-0.000366997
    -1.47,-0.00034676
    -1.485,-0.000358231
    -1.5,-0.000336128];
c=[
    -1.5,-0.000348927
    -1.485,-0.000342546
    -1.47,-0.000324503
    -1.455,-0.000315419
    -1.44,-0.000308335
    -1.425,-0.000296892
    -1.41,-0.000296293
    -1.395,-0.000286649
    -1.38,-0.000280006
    -1.365,-0.000274108
    -1.35,-0.000263901
    -1.335,-0.000262597
    -1.32,-0.000253728
    -1.305,-0.000247671
    -1.29,-0.000239042
    -1.275,-0.000238064
    -1.26,-0.00023244
    -1.245,-0.000224726
    -1.23,-0.000223417
    -1.215,-0.000223358
    -1.2,-0.000219177
    -1.185,-0.000214602
    -1.17,-0.000210634
    -1.155,-0.000207232
    -1.14,-0.000204743
    -1.125,-0.00020269
    -1.11,-0.000199122
    -1.095,-0.000194882
    -1.08,-0.000191547
    -1.065,-0.000187421
    -1.05,-0.000183881
    -1.035,-0.000180409
    -1.02,-0.000176955
    -1.005,-0.00017336
    -0.99,-0.000169604
    -0.975,-0.000166743
    -0.96,-0.000163159
    -0.945,-0.000159991
    -0.93,-0.000156194
    -0.915,-0.000153233
    -0.9,-0.000149667
    -0.885,-0.000146649
    -0.87,-0.00014426
    -0.855,-0.000141148
    -0.84,-0.0001377
    -0.825,-0.00013389
    -0.81,-0.000131572
    -0.795,-0.000128346
    -0.78,-0.00012545
    -0.765,-0.00012156
    -0.75,-0.000118194
    -0.735,-0.000114769
    -0.72,-0.000112213
    -0.705,-0.000109776
    -0.69,-0.000106218
    -0.675,-0.000103491
    -0.66,-9.96E-05
    -0.645,-9.70E-05
    -0.63,-9.40E-05
    -0.615,-9.10E-05
    -0.6,-8.82E-05
    -0.585,-8.54E-05
    -0.57,-8.26E-05
    -0.555,-8.00E-05
    -0.54,-7.72E-05
    -0.525,-7.47E-05
    -0.51,-7.20E-05
    -0.495,-6.92E-05
    -0.48,-6.66E-05
    -0.465,-6.39E-05
    -0.45,-6.17E-05
    -0.435,-5.91E-05
    -0.42,-5.69E-05
    -0.405,-5.42E-05
    -0.39,-5.18E-05
    -0.375,-4.86E-05
    -0.36,-4.61E-05
    -0.345,-4.33E-05
    -0.33,-4.06E-05
    -0.315,-3.84E-05
    -0.3,-3.61E-05
    -0.285,-3.38E-05
    -0.27,-3.16E-05
    -0.255,-2.92E-05
    -0.24,-2.72E-05
    -0.225,-2.52E-05
    -0.21,-2.32E-05
    -0.195,-2.08E-05
    -0.18,-1.89E-05
    -0.165,-1.69E-05
    -0.15,-1.49E-05
    -0.135,-1.32E-05
    -0.12,-1.13E-05
    -0.105,-9.32E-06
    -0.09,-7.84E-06
    -0.075,-6.51E-06
    -0.06,-5.16E-06
    -0.045,-3.84E-06
    -0.03,-2.56E-06
    -0.015,-1.27E-06];
HRS=[c; a];
LRS=flipud(b);
tt=[a;b;c];

plot(tt(:,1),tt(:,2));
Vset=0.795;
Vreset=-1.02;





for ii=1:length(V)
    if V(ii)>Vset
        state(ii)=0;
    elseif V(ii)< Vreset
        state(ii)=1;
    else
        if ii==1
            state(ii)=1;
        else
            state(ii)=state(ii-1);
        end
    end
    if state(ii)==1 % HRS
        I(ii)=interp1(HRS(:,1),HRS(:,2),V(ii));
    elseif state(ii)==0 % LRS
        I(ii)=interp1(LRS(:,1),LRS(:,2),V(ii));
    else
    end
    
end

function [state, I]=rram_IV_0(V)
%close all;
%clear all;
%V=1.6;
%state=1; % 1 means HRS

a=[0,-1.67E-08
    0.015,2.28E-06
    0.03,4.58E-06
    0.045,6.87E-06
    0.06,9.27E-06
    0.075,1.15E-05
    0.09,1.38E-05
    0.105,1.65E-05
    0.12,1.89E-05
    0.135,2.08E-05
    0.15,2.31E-05
    0.165,2.36E-05
    0.18,2.59E-05
    0.195,2.86E-05
    0.21,3.05E-05
    0.225,3.43E-05
    0.24,3.70E-05
    0.255,4.14E-05
    0.27,4.35E-05
    0.285,4.66E-05
    0.3,4.67E-05
    0.315,4.80E-05
    0.33,4.75E-05
    0.345,5.38E-05
    0.36,6.45E-05
    0.375,6.97E-05
    0.39,7.29E-05
    0.405,7.61E-05
    0.42,8.22E-05
    0.435,8.46E-05
    0.45,8.84E-05
    0.465,9.06E-05
    0.48,0.000100591
    0.495,0.000110876
    0.51,0.000133265
    0.525,0.000146037
    0.54,0.000170982
    0.555,0.000185707
    0.57,0.000215374
    0.585,0.000284087
    0.6,0.000316898
    0.615,0.000363097
    0.63,0.000409764
    0.645,0.000462785
    0.66,0.000539921
    0.675,0.000583796
    0.69,0.000612294
    0.705,0.000699384
    0.72,0.000732555
    0.735,0.000841702
    0.75,0.000937985
    0.765,0.000989054
    0.78,0.000994327
    0.795,0.000999984
    0.81,0.000999982
    0.825,0.000999983
    0.84,0.000999981
    0.855,0.000999981
    0.87,0.000999982
    0.885,0.000999978
    0.9,0.000999982
    0.915,0.000999982
    0.93,0.000999986
    0.945,0.000999986
    0.96,0.000999984
    0.975,0.000999985
    0.99,0.000999985
    1.005,0.000999986
    1.02,0.000999991
    1.035,0.000999986
    1.05,0.000999997
    1.065,0.000999984
    1.08,0.000999989
    1.095,0.000999987
    1.11,0.000999985
    1.125,0.000999989
    1.14,0.000999985
    1.155,0.000999988
    1.17,0.000999984
    1.185,0.000999986
    1.2,0.000999982
    1.215,0.000999982
    1.23,0.000999981
    1.245,0.000999978
    1.26,0.000999983
    1.275,0.000999979
    1.29,0.00099999
    1.305,0.000999978
    1.32,0.000999983
    1.335,0.000999974
    1.35,0.000999983
    1.365,0.00099998
    1.38,0.000999975
    1.395,0.000999982
    1.41,0.000999979
    1.425,0.000999987
    1.44,0.00099998
    1.455,0.000999987
    1.47,0.000999984
    1.485,0.000999987
    1.5,0.000999987];

b=[1.5,0.00099999
    1.485,0.000999987
    1.47,0.000999983
    1.455,0.000999985
    1.44,0.000999982
    1.425,0.000999981
    1.41,0.000999978
    1.395,0.000999981
    1.38,0.000999982
    1.365,0.000999983
    1.35,0.000999981
    1.335,0.000999983
    1.32,0.000999982
    1.305,0.000999985
    1.29,0.000999987
    1.275,0.000999985
    1.26,0.000999985
    1.245,0.000999987
    1.23,0.000999982
    1.215,0.000999983
    1.2,0.00099998
    1.185,0.000999982
    1.17,0.000999983
    1.155,0.000999986
    1.14,0.000999984
    1.125,0.000999987
    1.11,0.000999986
    1.095,0.000999989
    1.08,0.000999987
    1.065,0.000999989
    1.05,0.000999986
    1.035,0.000999987
    1.02,0.000999985
    1.005,0.00099998
    0.99,0.000999983
    0.975,0.00099998
    0.96,0.000999984
    0.945,0.000999978
    0.93,0.000999986
    0.915,0.00099998
    0.9,0.000999984
    0.885,0.000999984
    0.87,0.000999986
    0.855,0.000999985
    0.84,0.000999986
    0.825,0.000999984
    0.81,0.000999985
    0.795,0.000999984
    0.78,0.000999982
    0.765,0.000999982
    0.75,0.00099998
    0.735,0.000999984
    0.72,0.000989086
    0.705,0.000999855
    0.69,0.000984134
    0.675,0.000983059
    0.66,0.000943547
    0.645,0.000934696
    0.63,0.000889644
    0.615,0.000888511
    0.6,0.000838364
    0.585,0.000830133
    0.57,0.00076996
    0.555,0.000775458
    0.54,0.000722938
    0.525,0.000731633
    0.51,0.000684023
    0.495,0.000689146
    0.48,0.000662566
    0.465,0.000641055
    0.45,0.000606194
    0.435,0.000582718
    0.42,0.00055391
    0.405,0.00054781
    0.39,0.00053082
    0.375,0.000512879
    0.36,0.000490547
    0.345,0.000469315
    0.33,0.000436882
    0.315,0.000423954
    0.3,0.000401018
    0.285,0.000381987
    0.27,0.000349017
    0.255,0.000333582
    0.24,0.00031211
    0.225,0.000286247
    0.21,0.000269863
    0.195,0.000245575
    0.18,0.000236428
    0.165,0.000214778
    0.15,0.000201152
    0.135,0.000177632
    0.12,0.000160172
    0.105,0.000136102
    0.09,0.000120107
    0.075,9.48E-05
    0.06,7.52E-05
    0.045,5.57E-05
    0.03,3.71E-05
    0.015,1.85E-05
    0,-1.17E-07
    -0.015,-1.90E-05
    -0.03,-3.73E-05
    -0.045,-5.83E-05
    -0.06,-7.63E-05
    -0.075,-9.92E-05
    -0.09,-0.000115685
    -0.105,-0.000131246
    -0.12,-0.00015089
    -0.135,-0.000166532
    -0.15,-0.000188743
    -0.165,-0.000206761
    -0.18,-0.000229948
    -0.195,-0.000253799
    -0.21,-0.000278245
    -0.225,-0.00030166
    -0.24,-0.000310197
    -0.255,-0.000338302
    -0.27,-0.00033843
    -0.285,-0.000362393
    -0.3,-0.000383863
    -0.315,-0.000407178
    -0.33,-0.000422814
    -0.345,-0.00045099
    -0.36,-0.000464403
    -0.375,-0.000492912
    -0.39,-0.000501098
    -0.405,-0.000532374
    -0.42,-0.000544545
    -0.435,-0.000578782
    -0.45,-0.000571703
    -0.465,-0.000620778
    -0.48,-0.000635531
    -0.495,-0.000679281
    -0.51,-0.000675243
    -0.525,-0.000708484
    -0.54,-0.000694653
    -0.555,-0.000728363
    -0.57,-0.000733862
    -0.585,-0.000766577
    -0.6,-0.000796588
    -0.615,-0.000833743
    -0.63,-0.000818588
    -0.645,-0.000874453
    -0.66,-0.000841807
    -0.675,-0.000899363
    -0.69,-0.000895216
    -0.705,-0.000950533
    -0.72,-0.000954516
    -0.735,-0.000962096
    -0.75,-0.000924369
    -0.765,-0.000934672
    -0.78,-0.000889604
    -0.795,-0.000895101
    -0.81,-0.00080126
    -0.825,-0.000789337
    -0.84,-0.000677321
    -0.855,-0.000685367
    -0.87,-0.000672481
    -0.885,-0.000661169
    -0.9,-0.000657161
    -0.915,-0.000640442
    -0.93,-0.00063838
    -0.945,-0.000637233
    -0.96,-0.0006348
    -0.975,-0.000634257
    -0.99,-0.000600578
    -1.005,-0.000500394
    -1.02,-0.000412268
    -1.035,-0.000405838
    -1.05,-0.000414934
    -1.065,-0.000431699
    -1.08,-0.000434159
    -1.095,-0.000421283
    -1.11,-0.000435067
    -1.125,-0.000430212
    -1.14,-0.000489794
    -1.155,-0.000491552
    -1.17,-0.000560577
    -1.185,-0.000541462
    -1.2,-0.000563879
    -1.215,-0.000583615
    -1.23,-0.00057386
    -1.245,-0.000557601
    -1.26,-0.000561495
    -1.275,-0.000582281
    -1.29,-0.000582663
    -1.305,-0.000549542
    -1.32,-0.000576217
    -1.335,-0.000581278
    -1.35,-0.000649228
    -1.365,-0.000645519
    -1.38,-0.000656902
    -1.395,-0.000612611
    -1.41,-0.000633566
    -1.425,-0.000610956
    -1.44,-0.00063458
    -1.455,-0.000673317
    -1.47,-0.000674385
    -1.485,-0.00063312
    -1.5,-0.000623939];

c=[-1.5,-0.000636484
    -1.485,-0.000649291
    -1.47,-0.00060347
    -1.455,-0.000595033
    -1.44,-0.000578454
    -1.425,-0.000578785
    -1.41,-0.00053541
    -1.395,-0.000526701
    -1.38,-0.000508864
    -1.365,-0.000515631
    -1.35,-0.000497069
    -1.335,-0.000510354
    -1.32,-0.000488823
    -1.305,-0.000478256
    -1.29,-0.000452605
    -1.275,-0.000459607
    -1.26,-0.000452742
    -1.245,-0.000437585
    -1.23,-0.000432304
    -1.215,-0.00041755
    -1.2,-0.000412801
    -1.185,-0.000403068
    -1.17,-0.000402107
    -1.155,-0.000390505
    -1.14,-0.000380928
    -1.125,-0.000369515
    -1.11,-0.000367555
    -1.095,-0.000352587
    -1.08,-0.000349137
    -1.065,-0.000333429
    -1.05,-0.000331528
    -1.035,-0.000327837
    -1.02,-0.000324537
    -1.005,-0.000310956
    -0.99,-0.000307557
    -0.975,-0.000289376
    -0.96,-0.000287909
    -0.945,-0.000277177
    -0.93,-0.000276233
    -0.915,-0.000271349
    -0.9,-0.000267246
    -0.885,-0.000254508
    -0.87,-0.000253206
    -0.855,-0.000239868
    -0.84,-0.000239279
    -0.825,-0.000226688
    -0.81,-0.00022903
    -0.795,-0.00021604
    -0.78,-0.000214627
    -0.765,-0.00021045
    -0.75,-0.000206572
    -0.735,-0.000196183
    -0.72,-0.000193558
    -0.705,-0.000185182
    -0.69,-0.000182328
    -0.675,-0.00017627
    -0.66,-0.000172121
    -0.645,-0.000166154
    -0.63,-0.000160854
    -0.615,-0.000156122
    -0.6,-0.000151546
    -0.585,-0.000146454
    -0.57,-0.000141615
    -0.555,-0.000134126
    -0.54,-0.000129535
    -0.525,-0.000125273
    -0.51,-0.00012301
    -0.495,-0.000118059
    -0.48,-0.00011371
    -0.465,-0.000108196
    -0.45,-0.000103763
    -0.435,-9.90E-05
    -0.42,-9.59E-05
    -0.405,-9.13E-05
    -0.39,-8.74E-05
    -0.375,-8.20E-05
    -0.36,-7.89E-05
    -0.345,-7.45E-05
    -0.33,-7.17E-05
    -0.315,-6.79E-05
    -0.3,-6.41E-05
    -0.285,-6.05E-05
    -0.27,-5.74E-05
    -0.255,-5.37E-05
    -0.24,-4.95E-05
    -0.225,-4.57E-05
    -0.21,-4.22E-05
    -0.195,-3.87E-05
    -0.18,-3.57E-05
    -0.165,-3.25E-05
    -0.15,-2.91E-05
    -0.135,-2.56E-05
    -0.12,-2.21E-05
    -0.105,-1.93E-05
    -0.09,-1.61E-05
    -0.075,-1.31E-05
    -0.06,-1.04E-05
    -0.045,-7.56E-06
    -0.03,-5.03E-06
    -0.015,-2.49E-06
    ];
HRS=[c; a];
LRS=flipud(b);
tt=[a;b;c];

plot(tt(:,1),tt(:,2));
Vset=0.765;
Vreset=-1.02;







for ii=1:length(V)
    if V(ii)>Vset
        state(ii)=0;
    elseif V(ii)< Vreset
        state(ii)=1;
    else
        if ii==1
            state(ii)=1;
        else
            state(ii)=state(ii-1);
        end
    end
    if state(ii)==1 % HRS
        I(ii)=interp1(HRS(:,1),HRS(:,2),V(ii));
    elseif state(ii)==0 % LRS
        I(ii)=interp1(LRS(:,1),LRS(:,2),V(ii));
    else
    end
    
end
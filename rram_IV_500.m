function [state, I]=rram_IV_NoAnneal(V)
%close all;
%clear all;
%V=linspace(-1.5,1.5,100);
%state=1; % 1 means HRS

a=[0,-1.15E-09
    0.015,8.91E-07
    0.03,1.75E-06
    0.045,2.63E-06
    0.06,3.53E-06
    0.075,4.43E-06
    0.09,5.28E-06
    0.105,6.14E-06
    0.12,7.15E-06
    0.135,8.05E-06
    0.15,9.26E-06
    0.165,1.03E-05
    0.18,1.13E-05
    0.195,1.25E-05
    0.21,1.40E-05
    0.225,1.49E-05
    0.24,1.59E-05
    0.255,1.67E-05
    0.27,1.70E-05
    0.285,1.74E-05
    0.3,1.74E-05
    0.315,1.71E-05
    0.33,1.70E-05
    0.345,1.79E-05
    0.36,1.85E-05
    0.375,1.92E-05
    0.39,2.04E-05
    0.405,2.13E-05
    0.42,2.23E-05
    0.435,2.33E-05
    0.45,2.40E-05
    0.465,2.47E-05
    0.48,2.56E-05
    0.495,2.61E-05
    0.51,2.57E-05
    0.525,2.61E-05
    0.54,2.57E-05
    0.555,2.65E-05
    0.57,2.68E-05
    0.585,2.72E-05
    0.6,2.77E-05
    0.615,2.83E-05
    0.63,2.91E-05
    0.645,2.94E-05
    0.66,2.94E-05
    0.675,3.07E-05
    0.69,3.17E-05
    0.705,3.10E-05
    0.72,3.07E-05
    0.735,3.55E-05
    0.75,3.77E-05
    0.765,3.81E-05
    0.78,5.29E-05
    0.795,0.000485618
    0.81,0.000546379
    0.825,0.000583487
    0.84,0.000589209
    0.855,0.001000018
    0.87,0.001000017
    0.885,0.001000017
    0.9,0.001000018
    0.915,0.001000016
    0.93,0.001000017
    0.945,0.001000016
    0.96,0.001000017
    0.975,0.001000016
    0.99,0.001000017
    1.005,0.001000017
    1.02,0.001000016
    1.035,0.001000016
    1.05,0.001000017
    1.065,0.001000017
    1.08,0.001000017
    1.095,0.001000017
    1.11,0.001000017
    1.125,0.001000016
    1.14,0.001000016
    1.155,0.001000017
    1.17,0.001000016
    1.185,0.001000016
    1.2,0.001000015
    1.215,0.001000017
    1.23,0.001000017
    1.245,0.001000016
    1.26,0.001000017
    1.275,0.001000017
    1.29,0.001000017
    1.305,0.001000015
    1.32,0.001000016
    1.335,0.001000018
    1.35,0.001000016
    1.365,0.001000016
    1.38,0.001000016
    1.395,0.001000017
    1.41,0.001000016
    1.425,0.001000016
    1.44,0.001000016
    1.455,0.001000018
    1.47,0.001000016
    1.485,0.001000016
    1.5,0.001000017];

b=[
    1.5,0.001000017
    1.485,0.001000016
    1.47,0.001000015
    1.455,0.001000015
    1.44,0.001000017
    1.425,0.001000017
    1.41,0.001000017
    1.395,0.001000017
    1.38,0.001000017
    1.365,0.001000016
    1.35,0.001000017
    1.335,0.001000017
    1.32,0.001000016
    1.305,0.001000017
    1.29,0.001000017
    1.275,0.001000018
    1.26,0.001000017
    1.245,0.001000017
    1.23,0.001000017
    1.215,0.001000016
    1.2,0.001000015
    1.185,0.001000017
    1.17,0.001000016
    1.155,0.001000016
    1.14,0.001000015
    1.125,0.001000017
    1.11,0.001000016
    1.095,0.001000017
    1.08,0.001000016
    1.065,0.001000017
    1.05,0.001000016
    1.035,0.001000017
    1.02,0.001000017
    1.005,0.001000016
    0.99,0.001000016
    0.975,0.001000016
    0.96,0.001000017
    0.945,0.001000017
    0.93,0.001000017
    0.915,0.001000017
    0.9,0.001000017
    0.885,0.001000015
    0.87,0.001000017
    0.855,0.001000017
    0.84,0.001000017
    0.825,0.001000015
    0.81,0.001000015
    0.795,0.001000016
    0.78,0.001000015
    0.765,0.001000017
    0.75,0.001000016
    0.735,0.001000016
    0.72,0.001000016
    0.705,0.001000016
    0.69,0.001000015
    0.675,0.001000015
    0.66,0.001000015
    0.645,0.001000015
    0.63,0.001000016
    0.615,0.000982739
    0.6,0.000950975
    0.585,0.000903102
    0.57,0.000889019
    0.555,0.000860711
    0.54,0.000842595
    0.525,0.000819711
    0.51,0.000795484
    0.495,0.000769805
    0.48,0.000744059
    0.465,0.000716566
    0.45,0.000691497
    0.435,0.000668869
    0.42,0.000642837
    0.405,0.000616031
    0.39,0.000592606
    0.375,0.000564754
    0.36,0.000544127
    0.345,0.000516638
    0.33,0.000490428
    0.315,0.00047119
    0.3,0.000438683
    0.285,0.000418502
    0.27,0.000394124
    0.255,0.00037233
    0.24,0.000353215
    0.225,0.000328131
    0.21,0.000308492
    0.195,0.000283892
    0.18,0.00026011
    0.165,0.000239019
    0.15,0.000218618
    0.135,0.000196724
    0.12,0.00017409
    0.105,0.000151532
    0.09,0.000130733
    0.075,0.000108896
    0.06,8.67E-05
    0.045,6.50E-05
    0.03,4.32E-05
    0.015,2.16E-05
    0,-4.43E-08
    -0.015,-2.15E-05
    -0.03,-4.38E-05
    -0.045,-6.43E-05
    -0.06,-8.65E-05
    -0.075,-0.000107678
    -0.09,-0.000128633
    -0.105,-0.000150937
    -0.12,-0.000172912
    -0.135,-0.000195735
    -0.15,-0.000215134
    -0.165,-0.000239173
    -0.18,-0.000261359
    -0.195,-0.00028503
    -0.21,-0.000307634
    -0.225,-0.000330541
    -0.24,-0.000352123
    -0.255,-0.00037573
    -0.27,-0.000394939
    -0.285,-0.00041809
    -0.3,-0.000437485
    -0.315,-0.000461379
    -0.33,-0.000481536
    -0.345,-0.000522597
    -0.36,-0.000524293
    -0.375,-0.000561332
    -0.39,-0.000592246
    -0.405,-0.000614913
    -0.42,-0.000637899
    -0.435,-0.000657907
    -0.45,-0.000685059
    -0.465,-0.000709909
    -0.48,-0.000734027
    -0.495,-0.000756877
    -0.51,-0.000773158
    -0.525,-0.000789369
    -0.54,-0.000810985
    -0.555,-0.000817166
    -0.57,-0.000854371
    -0.585,-0.000869981
    -0.6,-0.000904165
    -0.615,-0.000913032
    -0.63,-0.000941756
    -0.645,-0.00096049
    -0.66,-0.000975499
    -0.675,-0.000962826
    -0.69,-0.000939556
    -0.705,-0.000870506
    -0.72,-0.000859616
    -0.735,-0.000831892
    -0.75,-0.000839233
    -0.765,-0.000850171
    -0.78,-0.000829078
    -0.795,-0.000825641
    -0.81,-0.000818749
    -0.825,-0.00076739
    -0.84,-0.000746024
    -0.855,-0.000671968
    -0.87,-0.000640322
    -0.885,-0.00064284
    -0.9,-0.000625356
    -0.915,-0.000565426
    -0.93,-0.000596017
    -0.945,-0.000603897
    -0.96,-0.000577371
    -0.975,-0.000619376
    -0.99,-0.000582575
    -1.005,-0.000579852
    -1.02,-0.000591485
    -1.035,-0.000611283
    -1.05,-0.000546021
    -1.065,-0.000550977
    -1.08,-0.000544363
    -1.095,-0.00056923
    -1.11,-0.000563373
    -1.125,-0.000573821
    -1.14,-0.000573199
    -1.155,-0.000557561
    -1.17,-0.000556326
    -1.185,-0.000533852
    -1.2,-0.000537951
    -1.215,-0.000510628
    -1.23,-0.00049612
    -1.245,-0.000592764
    -1.26,-0.000654123
    -1.275,-0.000664629
    -1.29,-0.00057208
    -1.305,-0.000503696
    -1.32,-0.00053822
    -1.335,-0.000557972
    -1.35,-0.000374157
    -1.365,-0.000347326
    -1.38,-0.000330085
    -1.395,-0.00033487
    -1.41,-0.000378082
    -1.425,-0.00035699
    -1.44,-0.000380499
    -1.455,-0.00032565
    -1.47,-0.000347398
    -1.485,-0.000375502
    -1.5,-0.000392265];

c=[
    -1.5,-0.000396354
    -1.485,-0.000383407
    -1.47,-0.000343494
    -1.455,-0.000361655
    -1.44,-0.000391129
    -1.425,-0.000404202
    -1.41,-0.000408749
    -1.395,-0.000409119
    -1.38,-0.000405824
    -1.365,-0.000391997
    -1.35,-0.000368897
    -1.335,-0.000366692
    -1.32,-0.000365884
    -1.305,-0.000357997
    -1.29,-0.000356772
    -1.275,-0.00034777
    -1.26,-0.00033511
    -1.245,-0.000326988
    -1.23,-0.000313511
    -1.215,-0.000297851
    -1.2,-0.00028226
    -1.185,-0.00028022
    -1.17,-0.000274865
    -1.155,-0.000264645
    -1.14,-0.000256509
    -1.125,-0.00025223
    -1.11,-0.000238044
    -1.095,-0.000231369
    -1.08,-0.000227289
    -1.065,-0.000218125
    -1.05,-0.000213456
    -1.035,-0.000212078
    -1.02,-0.0002022
    -1.005,-0.000198193
    -0.99,-0.000192446
    -0.975,-0.000189207
    -0.96,-0.000183361
    -0.945,-0.00018003
    -0.93,-0.000173302
    -0.915,-0.000168072
    -0.9,-0.000163795
    -0.885,-0.000156633
    -0.87,-0.000155098
    -0.855,-0.000150397
    -0.84,-0.000147771
    -0.825,-0.000144896
    -0.81,-0.000139641
    -0.795,-0.000137716
    -0.78,-0.000132924
    -0.765,-0.000130676
    -0.75,-0.000126618
    -0.735,-0.000122389
    -0.72,-0.000118754
    -0.705,-0.000114521
    -0.69,-0.000111451
    -0.675,-0.000108085
    -0.66,-0.000103889
    -0.645,-0.000100753
    -0.63,-9.73E-05
    -0.615,-9.44E-05
    -0.6,-9.06E-05
    -0.585,-8.69E-05
    -0.57,-8.37E-05
    -0.555,-8.08E-05
    -0.54,-7.76E-05
    -0.525,-7.35E-05
    -0.51,-7.10E-05
    -0.495,-6.77E-05
    -0.48,-6.56E-05
    -0.465,-6.30E-05
    -0.45,-6.03E-05
    -0.435,-5.76E-05
    -0.42,-5.46E-05
    -0.405,-5.18E-05
    -0.39,-4.95E-05
    -0.375,-4.68E-05
    -0.36,-4.38E-05
    -0.345,-4.13E-05
    -0.33,-3.90E-05
    -0.315,-3.67E-05
    -0.3,-3.37E-05
    -0.285,-3.17E-05
    -0.27,-2.94E-05
    -0.255,-2.75E-05
    -0.24,-2.52E-05
    -0.225,-2.33E-05
    -0.21,-2.13E-05
    -0.195,-1.95E-05
    -0.18,-1.76E-05
    -0.165,-1.58E-05
    -0.15,-1.40E-05
    -0.135,-1.24E-05
    -0.12,-1.09E-05
    -0.105,-9.27E-06
    -0.09,-7.80E-06
    -0.075,-6.34E-06
    -0.06,-4.84E-06
    -0.045,-3.54E-06
    -0.03,-2.30E-06
    -0.015,-1.11E-06
    ];
HRS=[c; a];
LRS=flipud(b);
tt=[a;b;c];

plot(tt(:,1),tt(:,2));
Vset=0.855;
Vreset=-1.35;






for ii=1:length(V)
    if V(ii)>Vset
        state(ii)=0;
    elseif V(ii)< Vreset
        state(ii)=1;
    else
        if ii==1
            state(ii)=1;
        else
            state(ii)=state(ii-1);
        end
    end
    if state(ii)==1 % HRS
        I(ii)=interp1(HRS(:,1),HRS(:,2),V(ii));
    elseif state(ii)==0 % LRS
        I(ii)=interp1(LRS(:,1),LRS(:,2),V(ii));
    else
    end
    
end